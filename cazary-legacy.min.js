/*! Cazary (jQuery 1.2.4+) - JavaScript WYSIWYG editor (https://github.com/shimataro/cazary) */
(function(q,p,g){var F=p.document,l=function(){var a={po:{"Insert Image":"Wstaw obrazek","Size 5":"Rozmiar 5","Show Source":"Poka\u017c \u017ar\u00f3d\u0142o","Size 4":"Rozmiar 4","Justify Right":"Wyr\u00f3wnaj do prawej","Remove Format":"Usu\u0144 formatowanie","Justify Center":"Wyr\u00f3wnaj do \u015brodka",Italic:"Kursywa","Size 1":"Rozmiar 1",Subscript:"Indeks dolny",Preview:"Podgl\u0105d","Input link URL or E-mail address":"Wprowad\u017a adres URL lub E-mail",Bold:"Pogrubienie","Unordered List":"Punktory",
"Input image URL":"Adres obrazka",Undo:"Cofnij","Strike-Through":"Przekre\u015blenie","Horizontal Rule":"Pozioma linia",Superscript:"Indeks g\u00f3rny",Outdent:"Zmniejsz wci\u0119cie","Background Color":"Kolor t\u0142a","Size 7":"Rozmiar 7","Size 6":"Rozmiar 6",Indent:"Zwi\u0119ksz wci\u0119cie","Size 3":"Rozmiar 3","Size 2":"Rozmiar 2",Insert:"Wstaw","Ordered List":"Numerowanie","Justify Left":"Wyr\u00f3wnanie do lewej","Justify Full":"Wyjustowanie","Foreground Color":"Kolor czcionki",Unlink:"Usu\u0144 link",
"Insert Link":"Wstaw link",Font:"Czcionka",Redo:"Powt\u00f3rz",Underline:"Podkre\u015blenie",Size:"Rozmiar"},ja:{"Insert Image":"\u753b\u50cf\u633f\u5165","Size 5":"\u30b5\u30a4\u30ba5","Show Source":"HTML\u30bd\u30fc\u30b9\u8868\u793a","Size 4":"\u30b5\u30a4\u30ba4","Justify Right":"\u53f3\u63c3\u3048","Remove Format":"\u66f8\u5f0f\u3092\u30af\u30ea\u30a2","Justify Center":"\u4e2d\u592e\u63c3\u3048",Italic:"\u659c\u4f53","Size 1":"\u30b5\u30a4\u30ba1",Subscript:"\u4e0b\u4ed8\u304d\u6587\u5b57",Preview:"\u30d7\u30ec\u30d3\u30e5\u30fc",
"Input link URL or E-mail address":"\u30ea\u30f3\u30af\u5148URL\u307e\u305f\u306f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",Bold:"\u592a\u5b57","Unordered List":"\u7b87\u6761\u66f8\u304d","Input image URL":"\u753b\u50cfURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",Undo:"\u5143\u306b\u623b\u3059","Strike-Through":"\u6253\u3061\u6d88\u3057\u7dda","Horizontal Rule":"\u6a2a\u7dda",Superscript:"\u4e0a\u4ed8\u304d\u6587\u5b57",Outdent:"\u5b57\u4e0b\u3052\u89e3\u9664",
"Background Color":"\u80cc\u666f\u8272","Size 7":"\u30b5\u30a4\u30ba7","Size 6":"\u30b5\u30a4\u30ba6",Indent:"\u5b57\u4e0b\u3052","Size 3":"\u30b5\u30a4\u30ba3","Size 2":"\u30b5\u30a4\u30ba2",Insert:"\u633f\u5165","Ordered List":"\u756a\u53f7\u4ed8\u304d\u30ea\u30b9\u30c8","Justify Left":"\u5de6\u63c3\u3048","Justify Full":"\u4e21\u7aef\u63c3\u3048","Foreground Color":"\u6587\u5b57\u8272",Unlink:"\u30ea\u30f3\u30af\u89e3\u9664","Insert Link":"\u30ea\u30f3\u30af\u633f\u5165",Font:"\u30d5\u30a9\u30f3\u30c8",
Redo:"\u3084\u308a\u76f4\u3057",Underline:"\u4e0b\u7dda",Size:"\u30b5\u30a4\u30ba"}},y=function(){var d;try{var h=p.navigator;d=h.browserLanguage||h.language||h.userLanguage}catch(y){d=g}h=a[d];if(h!==g)return h;d=d.split("-")[0];h=a[d];return h!==g?h:{}}();return function(a){return y[a]===g?a:y[a]}}(),K=function(){var a=/^[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~](\.?[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~])*@([\w\-]+\.)+(\w+)$/;return function(g){return 256<g.length||64<g.indexOf("@")||null==g.match(a)?
!1:!0}}(),B=function(){var a=/^https?:\/\//;return function(g){return null==g.match(a)?!1:!0}}(),Q=function(){return function(a,l,d){function h(a,e){"backcolor"==a&&u("hilitecolor")&&(a="hilitecolor");b();k.execCommand(a,!1,e)}function u(a){try{return k.queryCommandEnabled(a)}catch(e){return!1}}function p(){if(r.getSelection){var a=r.getSelection();return null===a||0===a.rangeCount?"":a.getRangeAt(0).toString()}return k.selection.createRange().text}function b(){r.focus();null!==D&&D.select()}var r=
a.contentWindow,k=r.document;a.contentDocument&&(k=a.contentDocument);var D=null;this.STATUS_NORMAL=0;this.STATUS_ACTIVE=1;this.STATUS_DISABLED=2;this.COMMAND_FONTNAME="fontname";this.COMMAND_FONTSIZE="fontsize";this.COMMAND_BOLD="bold";this.COMMAND_ITALIC="italic";this.COMMAND_UNDERLINE="underline";this.COMMAND_STRIKETHROUGH="strikethrough";this.COMMAND_REMOVEFORMAT="removeformat";this.COMMAND_FORECOLOR="forecolor";this.COMMAND_BACKCOLOR="backcolor";this.COMMAND_SUPERSCRIPT="superscript";this.COMMAND_SUBSCRIPT=
"subscript";this.COMMAND_JUSTIFYLEFT="justifyleft";this.COMMAND_JUSTIFYCENTER="justifycenter";this.COMMAND_JUSTIFYRIGHT="justifyright";this.COMMAND_JUSTIFYFULL="justifyfull";this.COMMAND_INDENT="indent";this.COMMAND_OUTDENT="outdent";this.COMMAND_ORDEREDLIST="insertorderedlist";this.COMMAND_UNORDEREDLIST="insertunorderedlist";this.COMMAND_INSERTHORIZONTALRULE="inserthorizontalrule";this.COMMAND_INSERTIMAGE="insertimage";this.COMMAND_CREATELINK="createlink";this.COMMAND_UNLINK="unlink";this.COMMAND_UNDO=
"undo";this.COMMAND_REDO="redo";this.contentWindow=r;this.contentDocument=k;this.getCurrentStatus=function(){var a={fontname:null,fontsize:null,forecolor:null,backcolor:null,bold:0,italic:0,underline:0,strikethrough:0,superscript:0,subscript:0,justifyleft:0,justifycenter:0,justifyright:0,justifyfull:0,insertorderedlist:0,insertunorderedlist:0,createlink:0,unlink:0,undo:0,redo:0};""==p()&&(a.createlink=2,a.unlink=2);q.each(["createlink","unlink","undo","redo"],function(b,e){u(e)||(a[e]=2)});for(var e=
r.getSelection?r.getSelection().anchorNode:k.selection.createRange().parentElement();null!==e;){if(e.tagName!==g)switch(e.tagName.toLowerCase()){case "b":case "strong":a.bold=1;break;case "i":case "em":a.italic=1;break;case "u":a.underline=1;break;case "s":case "strike":case "del":a.strikethrough=1;break;case "sup":a.superscript=1;break;case "sub":a.subscript=1;break;case "ol":a.insertorderedlist=1;break;case "ul":a.insertunorderedlist=1;break;case "font":0<e.face.length&&null===a.fontname&&(a.fontname=
e.face),0<e.size.length&&null===a.fontsize&&(a.fontsize=e.size),0<e.color.length&&null===a.forecolor&&(a.forecolor=e.color)}if(e.align!==g)switch(e.align.toLowerCase()){case "left":a.justifyleft=1;break;case "center":a.justifycenter=1;break;case "right":a.justifyright=1;break;case "justify":a.justifyfull=1}if(e.style!==g){var b=e.style;if(b.fontFamily!==g){var d=b.fontFamily;0<d.length&&null===a.fontname&&(a.fontname=d)}if(b.fontWeight!==g)switch(b.fontWeight.toLowerCase()){case "bold":case "bolder":a.bold=
1}if(b.fontStyle!==g)switch(b.fontStyle.toLowerCase()){case "italic":case "oblique":a.italic=1}b.textDecoration!==g&&(d=b.textDecoration.toLowerCase(),-1!==d.indexOf("underline")&&(a.underline=1),-1!==d.indexOf("line-through")&&(a.strikethrough=1));b.color!==g&&(d=b.color,0<d.length&&null===a.forecolor&&(a.forecolor=d));b.backgroundColor!==g&&(d=b.backgroundColor,0<d.length&&null===a.backcolor&&(a.backcolor=d));if(b.verticalAlign!==g)switch(b.verticalAlign.toLowerCase()){case "super":a.superscript=
1;break;case "sub":a.subscript=1}if(b.textAlign!==g)switch(b.textAlign.toLowerCase()){case "left":a.justifyleft=1;break;case "center":a.justifycenter=1;break;case "right":a.justifyright=1;break;case "justify":a.justifyfull=1}}e=e.parentNode}k.selection&&(D=k.selection.createRange());return a};this.execCommand=h;this.canExecCommand=u;this.value=function(a){if(a===g)return a=k.body.innerHTML,a=a.replace(/(<\/?)p\b/gi,"$1div").replace(/(<\/?)em\b/gi,"$1i").replace(/(<\/?)strong\b/gi,"$1b").replace(/(<\/?)del\b/gi,
"$1s").replace(/^<br\s*\/?>$/i,"");k.body.innerHTML=a};this.getSelectedText=p;this.insertText=function(a,e){if(r.getSelection){var d=k.createTextNode(a),g=r.getSelection();g.deleteFromDocument();g.getRangeAt(0).insertNode(d)}else k.selection.createRange().text=a;e?h("removeformat"):b()};this.setFocus=b;(function(a){var b='<!DOCTYPE html><html><head><meta charset="UTF-8" /><style type="text/css">'+d+"</style></head><body></body></html>";k.designMode="on";k.open();k.write(b);k.close();k.body.innerHTML=
a})(l)}}();q.fn.extend({cazary:function(a){function y(b){"string"===typeof b&&(b=q[b]!==g?q[b]:[b]);var d=a("<div />").addClass("cazary-commands-wrapper");a.each(b,function(){var b=a("<ul />").addClass("cazary-commands-list"),p=this.toLowerCase().split(" ");a.each(p,function(){var d=this.toString();"|"===d&&(d="separator");if(h[d]!==g){var e=l(h[d]),d="cazary-command-"+d,e=a("<li />").attr({unselectable:"on",title:e}).addClass(d).text(e);b.append(e)}});d.append(b)});return d}function d(){a(".cazary-panel").each(function(){var b=
".cazary-command-"+a(this).data("command");a(b).removeClass("cazary-active")}).remove()}var h={separator:"",fontname:"Font",fontsize:"Size",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strike-Through",removeformat:"Remove Format",forecolor:"Foreground Color",backcolor:"Background Color",superscript:"Superscript",subscript:"Subscript",justifyleft:"Justify Left",justifycenter:"Justify Center",justifyright:"Justify Right",justifyfull:"Justify Full",indent:"Indent",outdent:"Outdent",
insertorderedlist:"Ordered List",insertunorderedlist:"Unordered List",inserthorizontalrule:"Horizontal Rule",insertimage:"Insert Image",createlink:"Insert Link",unlink:"Unlink",undo:"Undo",redo:"Redo",source:"Show Source"},u={1:"Size 1",2:"Size 2",3:"Size 3",4:"Size 4",5:"Size 5",6:"Size 6",7:"Size 7"},q={MINIMAL:["bold italic underline strikethrough removeformat"],STANDARD:["fontname fontsize","bold italic underline strikethrough removeformat | forecolor backcolor | superscript subscript","source"],
FULL:"fontname fontsize;bold italic underline strikethrough removeformat | forecolor backcolor | superscript subscript;justifyleft justifycenter justifyright justifyfull | indent outdent | insertorderedlist insertunorderedlist;inserthorizontalrule insertimage createlink unlink;undo redo;source".split(";")};a(function(a){a(F).bind("click",function(){d()}).bind("keydown",function(a){27===a.keyCode&&d()})});return function(b){b=a.extend({mode:"rte",style:"body{margin:0px;padding:8px;}p{margin:0px;padding:0px;}",
fontnames:"sans-serif;serif;cursive;fantasy;monospace;Arial;Arial Black;Comic Sans MS;Courier New;Narrow;Garamond;Georgia;Impact;Tahoma;Times New Roman;Trebuchet MS;Verdana".split(";"),colors:["#ffffff #ffcccc #ffcc99 #ffff99 #ffffcc #99ff99 #99ffff #ccffff #ccccff #ffccff".split(" "),"#cccccc #ff6666 #ff9966 #ffff66 #ffff33 #66ff99 #33ffff #66ffff #9999ff #ff99ff".split(" "),"#bbbbbb #ff0000 #ff9900 #ffcc66 #ffff00 #33ff33 #66cccc #33ccff #6666cc #cc66cc".split(" "),"#999999 #cc0000 #ff6600 #ffcc33 #ffcc00 #33cc00 #00cccc #3366ff #6633ff #cc33cc".split(" "),
"#666666 #990000 #cc6600 #cc9933 #999900 #009900 #339999 #3333ff #6600cc #993399".split(" "),"#333333 #660000 #993300 #996633 #666600 #006600 #336666 #000099 #333399 #663366".split(" "),"#000000 #330000 #663300 #663333 #333300 #003300 #003333 #000066 #330099 #330033".split(" ")],commands:"STANDARD"},b);return this.each(function(){function h(a,b){d();c.execCommand(a,b);v()}function k(){var a=n.val();c.value(a);G();n.hide();C.css("display","");H.removeClass("cazary-disabled");z.removeClass("cazary-active");
v()}function q(){var a=c.value();n.val(a);C.hide();n.css("display","");H.addClass("cazary-disabled");z.addClass("cazary-active")}function L(b,t,I){var f=a(".cazary-panel");if(0<f.length){var w=f.data("id"),f=f.data("command");d();if(f===b&&w===J){E();return}}w=!1;switch(b){case c.COMMAND_FONTNAME:f=e(b,t.fontnames);w=!0;break;case c.COMMAND_FONTSIZE:f=O(b);w=!0;break;case c.COMMAND_FORECOLOR:case c.COMMAND_BACKCOLOR:f=P(b,t.colors);w=!0;break;case c.COMMAND_INSERTIMAGE:f=M(b);break;case c.COMMAND_CREATELINK:f=
N(b);break;default:return null}w&&f.find("li").bind("click",function(){var f=a(this).data("param");h(b,f)});t=I.addClass("cazary-active").offset();t.top+=I.outerHeight();f.addClass("cazary-panel").addClass("cazary-panel-"+b).data("id",J).data("command",b).css({left:t.left+"px",top:t.top+"px"}).bind("click",function(){return!1}).appendTo(a(F.body)).find(":text:first").trigger("focus");return f}function e(b,c){var d=a("<ul />").addClass("cazary-widget-select");a.each(c,function(){var f=this.toString(),
f=a("<li />").attr({unselectable:"on",title:f}).css({"font-family":f}).data("param",f).text(f);d.append(f)});return a("<div>").append(d)}function O(b){var c=a("<ul />").addClass("cazary-widget-select");a.each(u,function(b,f){f=l(f);var d=a("<li />").attr({unselectable:"on",title:f}).data("param",b),e=a("<font />").attr({size:b}).text(f);c.append(d.append(e))});return a("<div>").append(c)}function P(b,c){$panel=a("<div>");a.each(c,function(){var b=a("<ul />").addClass("cazary-widget-select-color");
a.each(this,function(){var f=this.toString(),f=a("<li />").attr({unselectable:"on",title:f}).css({"background-color":f}).data("param",f).text(f);b.append(f)});$panel.append(b)});return $panel}function M(b){function c(){var a=$panel.find(".cazary-widget-insertimage-url"),f=a.val();if(!B(f))return a.trigger("focus"),!1;h(b,f);return!1}$panel=a("<div>").append(a("<form />").attr("action","#").append(a("<div />").append(a("<fieldset />").append(a("<legend />").text(l("Input image URL"))).append(a('<input type="text" />').addClass("cazary-widget-insertimage-url").attr({required:"required",
placeholder:l("http://example.com/path/to/image.jpg")}))).append(a('<input type="submit" />').addClass("cazary-widget-submit").val(l("Insert")))).append(a("<fieldset />").addClass("cazary-widget-preview").append(a("<legend />").text(l("Preview"))).append(a("<img />").addClass("cazary-widget-preview-insertimage"))));$panel.find("form").bind("submit",c);$panel.find(".cazary-widget-submit").bind("click",c);$panel.find(".cazary-widget-insertimage-url").bind("keydown paste",function(){var b=a(this);p.setTimeout(function(){var a=
b.val(),c=b.data("url_old");a!==c&&(b.data("url_old",a),c=$panel.find(".cazary-widget-preview"),B(a)?(c.show(),$panel.find(".cazary-widget-preview-insertimage").attr("src",a)):c.hide())},10)});return $panel}function N(b){function c(){var a=d.find(".cazary-widget-createlink-url"),e=a.val();if(K(e))e="mailto:"+e;else if(!B(e))return a.trigger("focus"),!1;h(b,e);return!1}var d=a("<div>").append(a("<form />").attr("action","#").append(a("<div />").append(a("<fieldset />").append(a("<legend />").text(l("Input link URL or E-mail address"))).append(a('<input type="text" />').addClass("cazary-widget-createlink-url").attr({required:"required",
placeholder:l("http://example.com/, someone@example.com")}))).append(a('<input type="button" />').addClass("cazary-widget-submit").val(l("Insert")))).append(a("<fieldset />").addClass("cazary-widget-preview").append(a("<legend />").text(l("Preview"))).append(a("<iframe />").addClass("cazary-widget-preview-createlink"))));d.find("form").bind("submit",c);d.find(".cazary-widget-submit").bind("click",c);d.find(".cazary-widget-createlink-url").bind("keydown paste",function(){var b=a(this);p.setTimeout(function(){var a=
b.val(),c=b.data("url_old");a!==c&&(b.data("url_old",a),c=d.find(".cazary-widget-preview"),B(a)?(c.show(),d.find(".cazary-widget-preview-createlink").attr("src",a)):c.hide())},10)});return d}function v(){var a=c.getCurrentStatus(),b;for(b in a){var d=a[b],f=m.find(".cazary-command-"+b);if(b===c.COMMAND_FONTNAME){var e=d;null===e&&(d="",e=f.attr("title"));f.css({"font-family":d}).text(e)}else b===c.COMMAND_FONTSIZE?(e=d,e=null===e?f.attr("title"):l(u[e]),f.text(e)):b===c.COMMAND_FORECOLOR||b===c.COMMAND_BACKCOLOR?
(m.find(".cazary-command-"+b),null===d?m.find(".cazary-command-"+b).css("background-color",""):m.find(".cazary-command-"+b).css("background-color",d)):(d===c.STATUS_ACTIVE?f.addClass("cazary-active"):f.removeClass("cazary-active"),d===c.STATUS_DISABLED?f.addClass("cazary-disabled"):f.removeClass("cazary-disabled"))}}function E(){z.hasClass("cazary-active")?n.trigger("focus"):c.setFocus()}function G(){var b=a(c.contentDocument.body);0===b.text().length?b.addClass("empty"):b.removeClass("empty")}var J=
parseInt(1E4*Math.random()),n=a(this),m=a('<div class="cazary"><iframe class="cazary-edit" src="javascript:"></iframe></div>').css({width:n.width()});m.prepend(y(b.commands));var C=m.find(".cazary-edit").css({height:n.height()}),z=m.find("ul.cazary-commands-list li.cazary-command-source"),H=m.find("ul.cazary-commands-list li:not(.cazary-command-source)");n.hide().before(m).insertAfter(C).addClass("cazary-source");var A=b.style,x=n.attr("placeholder");x!==g&&(x=x.replace("'","\\'"),A+="body.empty:before{position:fixed;color:#888;content:'"+
x+"';}");var c=new Q(C.get(0),n.val(),A),A=[c.COMMAND_BOLD,c.COMMAND_ITALIC,c.COMMAND_UNDERLINE,c.COMMAND_STRIKETHROUGH,c.COMMAND_REMOVEFORMAT,c.COMMAND_SUPERSCRIPT,c.COMMAND_SUBSCRIPT,c.COMMAND_JUSTIFYLEFT,c.COMMAND_JUSTIFYCENTER,c.COMMAND_JUSTIFYRIGHT,c.COMMAND_JUSTIFYFULL,c.COMMAND_INDENT,c.COMMAND_OUTDENT,c.COMMAND_ORDEREDLIST,c.COMMAND_UNORDEREDLIST,c.COMMAND_INSERTHORIZONTALRULE,c.COMMAND_UNLINK,c.COMMAND_UNDO,c.COMMAND_REDO],x=[c.COMMAND_FONTNAME,c.COMMAND_FONTSIZE,c.COMMAND_FORECOLOR,c.COMMAND_BACKCOLOR,
c.COMMAND_INSERTIMAGE,c.COMMAND_CREATELINK];"html"==b.mode?q():k();a(c.contentDocument).bind("select",function(){v()}).bind("mouseup",function(){d();v()}).bind("keydown",function(a){27===a.keyCode&&d()}).bind("keyup paste",function(){p.setTimeout(function(){v();G()},10)});a(c.contentWindow).bind("focus",function(){d();v()}).bind("blur",function(){n.val(c.value())});m.find("ul.cazary-commands-list li").bind("click",function(b){a(this).hasClass("cazary-disabled")&&(b.stopImmediatePropagation(),E())});
z.bind("click",function(){z.hasClass("cazary-active")?k():q();E()});a.each(A,function(){var a=this.toLowerCase();m.find(".cazary-command-"+a).bind("click",function(){h(a)})});a.each(x,function(){var c=this.toLowerCase();m.find(".cazary-command-"+c).bind("click",function(){var d=a(this);L(c,b,d);return!1})})})}}(q)})})(jQuery,window);