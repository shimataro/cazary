/*! Cazary (jQuery 1.7+) - JavaScript WYSIWYG editor (https://github.com/shimataro/cazary) */
(function(v,w,d){var I=w.document,n=function(){var a={po:{"Insert Image":"Wstaw obrazek","Size 5":"Rozmiar 5","Show Source":"Poka\u017c \u017ar\u00f3d\u0142o","Size 4":"Rozmiar 4","Justify Right":"Wyr\u00f3wnaj do prawej","Remove Format":"Usu\u0144 formatowanie","Justify Center":"Wyr\u00f3wnaj do \u015brodka",Italic:"Kursywa","Size 1":"Rozmiar 1",Subscript:"Indeks dolny",Preview:"Podgl\u0105d","Input link URL or E-mail address":"Wprowad\u017a adres URL lub E-mail",Bold:"Pogrubienie","Unordered List":"Punktory",
"Input image URL":"Adres obrazka",Undo:"Cofnij","Strike-Through":"Przekre\u015blenie","Horizontal Rule":"Pozioma linia",Superscript:"Indeks g\u00f3rny",Outdent:"Zmniejsz wci\u0119cie","Background Color":"Kolor t\u0142a","Size 7":"Rozmiar 7","Size 6":"Rozmiar 6",Indent:"Zwi\u0119ksz wci\u0119cie","Size 3":"Rozmiar 3","Size 2":"Rozmiar 2",Insert:"Wstaw","Ordered List":"Numerowanie","Justify Left":"Wyr\u00f3wnanie do lewej","Justify Full":"Wyjustowanie","Foreground Color":"Kolor czcionki",Unlink:"Usu\u0144 link",
"Insert Link":"Wstaw link",Font:"Czcionka",Redo:"Powt\u00f3rz",Underline:"Podkre\u015blenie",Size:"Rozmiar"},ja:{"Insert Image":"\u753b\u50cf\u633f\u5165","Size 5":"\u30b5\u30a4\u30ba5","Show Source":"HTML\u30bd\u30fc\u30b9\u8868\u793a","Size 4":"\u30b5\u30a4\u30ba4","Justify Right":"\u53f3\u63c3\u3048","Remove Format":"\u66f8\u5f0f\u3092\u30af\u30ea\u30a2","Justify Center":"\u4e2d\u592e\u63c3\u3048",Italic:"\u659c\u4f53","Size 1":"\u30b5\u30a4\u30ba1",Subscript:"\u4e0b\u4ed8\u304d\u6587\u5b57",Preview:"\u30d7\u30ec\u30d3\u30e5\u30fc",
"Input link URL or E-mail address":"\u30ea\u30f3\u30af\u5148URL\u307e\u305f\u306f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",Bold:"\u592a\u5b57","Unordered List":"\u7b87\u6761\u66f8\u304d","Input image URL":"\u753b\u50cfURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",Undo:"\u5143\u306b\u623b\u3059","Strike-Through":"\u6253\u3061\u6d88\u3057\u7dda","Horizontal Rule":"\u6a2a\u7dda",Superscript:"\u4e0a\u4ed8\u304d\u6587\u5b57",Outdent:"\u5b57\u4e0b\u3052\u89e3\u9664",
"Background Color":"\u80cc\u666f\u8272","Size 7":"\u30b5\u30a4\u30ba7","Size 6":"\u30b5\u30a4\u30ba6",Indent:"\u5b57\u4e0b\u3052","Size 3":"\u30b5\u30a4\u30ba3","Size 2":"\u30b5\u30a4\u30ba2",Insert:"\u633f\u5165","Ordered List":"\u756a\u53f7\u4ed8\u304d\u30ea\u30b9\u30c8","Justify Left":"\u5de6\u63c3\u3048","Justify Full":"\u4e21\u7aef\u63c3\u3048","Foreground Color":"\u6587\u5b57\u8272",Unlink:"\u30ea\u30f3\u30af\u89e3\u9664","Insert Link":"\u30ea\u30f3\u30af\u633f\u5165",Font:"\u30d5\u30a9\u30f3\u30c8",
Redo:"\u3084\u308a\u76f4\u3057",Underline:"\u4e0b\u7dda",Size:"\u30b5\u30a4\u30ba"}},B=function(){var b;try{var g=w.navigator;b=g.browserLanguage||g.language||g.userLanguage}catch(B){b=d}g=a[b];if(g!==d)return g;b=b.split("-")[0];g=a[b];return g!==d?g:{}}();return function(a){return B[a]===d?a:B[a]}}(),M=function(){var a=/^[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~](\.?[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~])*@([\w\-]+\.)+(\w+)$/;return function(d){return 256<d.length||64<d.indexOf("@")||null==d.match(a)?
!1:!0}}(),E=function(){var a=/^https?:\/\//;return function(d){return null==d.match(a)?!1:!0}}(),Q=function(){return function(a,n,b){function g(a,d){"backcolor"==a&&x("hilitecolor")&&(a="hilitecolor");y();e.execCommand(a,!1,d)}function x(a){try{return e.queryCommandEnabled(a)}catch(d){return!1}}function w(a){0===a.length&&(e.body.innerHTML="\u200b");e.body.innerHTML=a}function l(){if(p.getSelection){var a=p.getSelection();return null===a||0===a.rangeCount?"":a.getRangeAt(0).toString()}return e.selection.createRange().text}
function y(){p.focus();null!==G&&G.select()}var p=a.contentWindow,e=p.document;a.contentDocument&&(e=a.contentDocument);var G=null;this.STATUS_NORMAL=0;this.STATUS_ACTIVE=1;this.STATUS_DISABLED=2;this.COMMAND_FONTNAME="fontname";this.COMMAND_FONTSIZE="fontsize";this.COMMAND_BOLD="bold";this.COMMAND_ITALIC="italic";this.COMMAND_UNDERLINE="underline";this.COMMAND_STRIKETHROUGH="strikethrough";this.COMMAND_REMOVEFORMAT="removeformat";this.COMMAND_FORECOLOR="forecolor";this.COMMAND_BACKCOLOR="backcolor";
this.COMMAND_SUPERSCRIPT="superscript";this.COMMAND_SUBSCRIPT="subscript";this.COMMAND_JUSTIFYLEFT="justifyleft";this.COMMAND_JUSTIFYCENTER="justifycenter";this.COMMAND_JUSTIFYRIGHT="justifyright";this.COMMAND_JUSTIFYFULL="justifyfull";this.COMMAND_INDENT="indent";this.COMMAND_OUTDENT="outdent";this.COMMAND_ORDEREDLIST="insertorderedlist";this.COMMAND_UNORDEREDLIST="insertunorderedlist";this.COMMAND_INSERTHORIZONTALRULE="inserthorizontalrule";this.COMMAND_INSERTIMAGE="insertimage";this.COMMAND_CREATELINK=
"createlink";this.COMMAND_UNLINK="unlink";this.COMMAND_UNDO="undo";this.COMMAND_REDO="redo";this.contentWindow=p;this.contentDocument=e;this.getCurrentStatus=function(){var a={fontname:null,fontsize:null,forecolor:null,backcolor:null,bold:0,italic:0,underline:0,strikethrough:0,superscript:0,subscript:0,justifyleft:0,justifycenter:0,justifyright:0,justifyfull:0,insertorderedlist:0,insertunorderedlist:0,createlink:0,unlink:0,undo:0,redo:0};""==l()&&(a.createlink=2,a.unlink=2);v.each(["createlink","unlink",
"undo","redo"],function(d,b){x(b)||(a[b]=2)});for(var k=p.getSelection?p.getSelection().anchorNode:e.selection.createRange().parentElement();null!==k;){if(k.tagName!==d)switch(k.tagName.toLowerCase()){case "b":case "strong":a.bold=1;break;case "i":case "em":a.italic=1;break;case "u":a.underline=1;break;case "s":case "strike":case "del":a.strikethrough=1;break;case "sup":a.superscript=1;break;case "sub":a.subscript=1;break;case "ol":a.insertorderedlist=1;break;case "ul":a.insertunorderedlist=1;break;
case "font":0<k.face.length&&null===a.fontname&&(a.fontname=k.face),0<k.size.length&&null===a.fontsize&&(a.fontsize=k.size),0<k.color.length&&null===a.forecolor&&(a.forecolor=k.color)}if(k.align!==d)switch(k.align.toLowerCase()){case "left":a.justifyleft=1;break;case "center":a.justifycenter=1;break;case "right":a.justifyright=1;break;case "justify":a.justifyfull=1}if(k.style!==d){var h=k.style;if(h.fontFamily!==d){var b=h.fontFamily;0<b.length&&null===a.fontname&&(a.fontname=b)}if(h.fontWeight!==
d)switch(h.fontWeight.toLowerCase()){case "bold":case "bolder":a.bold=1}if(h.fontStyle!==d)switch(h.fontStyle.toLowerCase()){case "italic":case "oblique":a.italic=1}h.textDecoration!==d&&(b=h.textDecoration.toLowerCase(),-1!==b.indexOf("underline")&&(a.underline=1),-1!==b.indexOf("line-through")&&(a.strikethrough=1));h.color!==d&&(b=h.color,0<b.length&&null===a.forecolor&&(a.forecolor=b));h.backgroundColor!==d&&(b=h.backgroundColor,0<b.length&&null===a.backcolor&&(a.backcolor=b));if(h.verticalAlign!==
d)switch(h.verticalAlign.toLowerCase()){case "super":a.superscript=1;break;case "sub":a.subscript=1}if(h.textAlign!==d)switch(h.textAlign.toLowerCase()){case "left":a.justifyleft=1;break;case "center":a.justifycenter=1;break;case "right":a.justifyright=1;break;case "justify":a.justifyfull=1}}k=k.parentNode}e.selection&&(G=e.selection.createRange());return a};this.execCommand=g;this.canExecCommand=x;this.value=function(a){if(a===d)return a=e.body.innerHTML,a=a.replace(/(<\/?)p\b/gi,"$1div").replace(/(<\/?)em\b/gi,
"$1i").replace(/(<\/?)strong\b/gi,"$1b").replace(/(<\/?)del\b/gi,"$1s").replace(/^<br\s*\/?>$/i,"");w(a)};this.getSelectedText=l;this.insertText=function(a,b){if(p.getSelection){var d=e.createTextNode(a),l=p.getSelection();l.deleteFromDocument();l.getRangeAt(0).insertNode(d)}else e.selection.createRange().text=a;b?g("removeformat"):y()};this.setFocus=y;(function(a){var d='<!DOCTYPE html><html><head><meta charset="UTF-8" /><style type="text/css">'+b+"</style></head><body></body></html>";e.designMode=
"on";e.open();e.write(d);e.close();w(a)})(n)}}();v.fn.extend({cazary:function(a){function B(b){"string"===typeof b&&(b=v[b]!==d?v[b]:[b]);var y=a("<div />").addClass("cazary-commands-wrapper");a.each(b,function(){var b=a("<ul />").addClass("cazary-commands-list"),e=this.toLowerCase().split(" ");a.each(e,function(){var e=this.toString();"|"===e&&(e="separator");if(g[e]!==d){var l=n(g[e]),e="cazary-command-"+e,l=a("<li />").attr({unselectable:"on",title:l}).addClass(e).text(l);b.append(l)}});y.append(b)});
return y}function b(){a(".cazary-panel").each(function(){var b=".cazary-command-"+a(this).data("command");a(b).removeClass("cazary-active")}).remove()}var g={separator:"",fontname:"Font",fontsize:"Size",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strike-Through",removeformat:"Remove Format",forecolor:"Foreground Color",backcolor:"Background Color",superscript:"Superscript",subscript:"Subscript",justifyleft:"Justify Left",justifycenter:"Justify Center",justifyright:"Justify Right",
justifyfull:"Justify Full",indent:"Indent",outdent:"Outdent",insertorderedlist:"Ordered List",insertunorderedlist:"Unordered List",inserthorizontalrule:"Horizontal Rule",insertimage:"Insert Image",createlink:"Insert Link",unlink:"Unlink",undo:"Undo",redo:"Redo",source:"Show Source"},x={1:"Size 1",2:"Size 2",3:"Size 3",4:"Size 4",5:"Size 5",6:"Size 6",7:"Size 7"},v={MINIMAL:["bold italic underline strikethrough removeformat"],STANDARD:["fontname fontsize","bold italic underline strikethrough removeformat | forecolor backcolor | superscript subscript",
"source"],FULL:"fontname fontsize;bold italic underline strikethrough removeformat | forecolor backcolor | superscript subscript;justifyleft justifycenter justifyright justifyfull | indent outdent | insertorderedlist insertunorderedlist;inserthorizontalrule insertimage createlink unlink;undo redo;source".split(";")};a(function(a){a(I).on("click",function(){b()}).on("keydown",function(a){27===a.keyCode&&b()})});return function(l){l=a.extend({mode:"rte",style:"body{margin:0px;padding:8px;}p{margin:0px;padding:0px;}",
fontnames:"sans-serif;serif;cursive;fantasy;monospace;Arial;Arial Black;Comic Sans MS;Courier New;Narrow;Garamond;Georgia;Impact;Tahoma;Times New Roman;Trebuchet MS;Verdana".split(";"),colors:["#ffffff #ffcccc #ffcc99 #ffff99 #ffffcc #99ff99 #99ffff #ccffff #ccccff #ffccff".split(" "),"#cccccc #ff6666 #ff9966 #ffff66 #ffff33 #66ff99 #33ffff #66ffff #9999ff #ff99ff".split(" "),"#bbbbbb #ff0000 #ff9900 #ffcc66 #ffff00 #33ff33 #66cccc #33ccff #6666cc #cc66cc".split(" "),"#999999 #cc0000 #ff6600 #ffcc33 #ffcc00 #33cc00 #00cccc #3366ff #6633ff #cc33cc".split(" "),
"#666666 #990000 #cc6600 #cc9933 #999900 #009900 #339999 #3333ff #6600cc #993399".split(" "),"#333333 #660000 #993300 #996633 #666600 #006600 #336666 #000099 #333399 #663366".split(" "),"#000000 #330000 #663300 #663333 #333300 #003300 #003333 #000066 #330099 #330033".split(" ")],commands:"STANDARD"},l);return this.each(function(){function g(a,u){b();c.execCommand(a,u);z()}function p(){var a=r.val();c.value(a);J();r.hide();F.css("display","");K.removeClass("cazary-disabled");C.removeClass("cazary-active");
z()}function e(){var a=c.value();r.val(a);F.hide();r.css("display","");K.addClass("cazary-disabled");C.addClass("cazary-active")}function v(t,u,d){var f=a(".cazary-panel");if(0<f.length){var m=f.data("id"),f=f.data("command");b();if(f===t&&m===L){H();return}}m=!1;switch(t){case c.COMMAND_FONTNAME:f=N(t,u.fontnames);m=!0;break;case c.COMMAND_FONTSIZE:f=k(t);m=!0;break;case c.COMMAND_FORECOLOR:case c.COMMAND_BACKCOLOR:f=h(t,u.colors);m=!0;break;case c.COMMAND_INSERTIMAGE:f=P(t);break;case c.COMMAND_CREATELINK:f=
O(t);break;default:return null}if(m)f.on("click","li",function(){var f=a(this).data("param");g(t,f)});u=d.addClass("cazary-active").offset();u.top+=d.outerHeight();f.addClass("cazary-panel").addClass("cazary-panel-"+t).data("id",L).data("command",t).css({left:u.left+"px",top:u.top+"px"}).on("click",function(){return!1}).appendTo(a(I.body)).find(":text:first").trigger("focus");return f}function N(c,b){var d=a("<ul />").addClass("cazary-widget-select");a.each(b,function(){var f=this.toString(),f=a("<li />").attr({unselectable:"on",
title:f}).css({"font-family":f}).data("param",f).text(f);d.append(f)});return a("<div>").append(d)}function k(b){var c=a("<ul />").addClass("cazary-widget-select");a.each(x,function(b,f){f=n(f);var m=a("<li />").attr({unselectable:"on",title:f}).data("param",b),d=a("<font />").attr({size:b}).text(f);c.append(m.append(d))});return a("<div>").append(c)}function h(b,c){var d=a("<div>");a.each(c,function(){var f=a("<ul />").addClass("cazary-widget-select-color");a.each(this,function(){var b=this.toString(),
b=a("<li />").attr({unselectable:"on",title:b}).css({"background-color":b}).data("param",b).text(b);f.append(b)});d.append(f)});return d}function P(b){function c(){var a=d.find(".cazary-widget-insertimage-url"),m=a.val();if(!E(m))return a.trigger("focus"),!1;g(b,m);return!1}var d=a("<div>").append(a("<form />").attr("action","#").append(a("<div />").append(a("<fieldset />").append(a("<legend />").text(n("Input image URL"))).append(a('<input type="text" />').addClass("cazary-widget-insertimage-url").attr({required:"required",
placeholder:n("http://example.com/path/to/image.jpg")}))).append(a('<input type="submit" />').addClass("cazary-widget-submit").val(n("Insert")))).append(a("<fieldset />").addClass("cazary-widget-preview").append(a("<legend />").text(n("Preview"))).append(a("<img />").addClass("cazary-widget-preview-insertimage"))));return d.on("submit","form",c).on("click",".cazary-widget-submit",c).on("keydown paste",".cazary-widget-insertimage-url",function(){var b=a(this);w.setTimeout(function(){var a=b.val(),
c=b.data("url_old");a!==c&&(b.data("url_old",a),c=d.find(".cazary-widget-preview"),E(a)?(c.show(),d.find(".cazary-widget-preview-insertimage").attr("src",a)):c.hide())},10)})}function O(b){function c(){var a=d.find(".cazary-widget-createlink-url"),m=a.val();if(M(m))m="mailto:"+m;else if(!E(m))return a.trigger("focus"),!1;g(b,m);return!1}var d=a("<div>").append(a("<form />").attr("action","#").append(a("<div />").append(a("<fieldset />").append(a("<legend />").text(n("Input link URL or E-mail address"))).append(a('<input type="text" />').addClass("cazary-widget-createlink-url").attr({required:"required",
placeholder:n("http://example.com/, someone@example.com")}))).append(a('<input type="button" />').addClass("cazary-widget-submit").val(n("Insert")))).append(a("<fieldset />").addClass("cazary-widget-preview").append(a("<legend />").text(n("Preview"))).append(a("<iframe />").addClass("cazary-widget-preview-createlink"))));return d.on("submit","form",c).on("click",".cazary-widget-submit",c).on("keydown paste",".cazary-widget-createlink-url",function(){var b=a(this);w.setTimeout(function(){var a=b.val(),
c=b.data("url_old");a!==c&&(b.data("url_old",a),c=d.find(".cazary-widget-preview"),E(a)?(c.show(),d.find(".cazary-widget-preview-createlink").attr("src",a)):c.hide())},10)})}function z(){var a=c.getCurrentStatus(),b;for(b in a){var d=a[b],f=q.find(".cazary-command-"+b);if(b===c.COMMAND_FONTNAME){var e=d;null===e&&(d="",e=f.attr("title"));f.css({"font-family":d}).text(e)}else b===c.COMMAND_FONTSIZE?(e=d,e=null===e?f.attr("title"):n(x[e]),f.text(e)):b===c.COMMAND_FORECOLOR||b===c.COMMAND_BACKCOLOR?
(q.find(".cazary-command-"+b),null===d?q.find(".cazary-command-"+b).css("background-color",""):q.find(".cazary-command-"+b).css("background-color",d)):(d===c.STATUS_ACTIVE?f.addClass("cazary-active"):f.removeClass("cazary-active"),d===c.STATUS_DISABLED?f.addClass("cazary-disabled"):f.removeClass("cazary-disabled"))}}function H(){C.hasClass("cazary-active")?r.trigger("focus"):c.setFocus()}function J(){var b=a(c.contentDocument.body);0===b.text().length?b.addClass("empty"):b.removeClass("empty")}var L=
parseInt(1E4*Math.random()),r=a(this),q=a('<div class="cazary"><iframe class="cazary-edit" src="javascript:"></iframe></div>').css({width:r.width()});q.prepend(B(l.commands));var F=q.find(".cazary-edit").css({height:r.height()}),C=q.find("ul.cazary-commands-list li.cazary-command-source"),K=q.find("ul.cazary-commands-list li:not(.cazary-command-source)");r.hide().before(q).insertAfter(F).addClass("cazary-source");var D=l.style,A=r.attr("placeholder");A!==d&&(A=A.replace("'","\\'"),D+="body.empty:before{position:fixed;color:#888;content:'"+
A+"';}");var c=new Q(F.get(0),r.val(),D),D=[c.COMMAND_BOLD,c.COMMAND_ITALIC,c.COMMAND_UNDERLINE,c.COMMAND_STRIKETHROUGH,c.COMMAND_REMOVEFORMAT,c.COMMAND_SUPERSCRIPT,c.COMMAND_SUBSCRIPT,c.COMMAND_JUSTIFYLEFT,c.COMMAND_JUSTIFYCENTER,c.COMMAND_JUSTIFYRIGHT,c.COMMAND_JUSTIFYFULL,c.COMMAND_INDENT,c.COMMAND_OUTDENT,c.COMMAND_ORDEREDLIST,c.COMMAND_UNORDEREDLIST,c.COMMAND_INSERTHORIZONTALRULE,c.COMMAND_UNLINK,c.COMMAND_UNDO,c.COMMAND_REDO],A=[c.COMMAND_FONTNAME,c.COMMAND_FONTSIZE,c.COMMAND_FORECOLOR,c.COMMAND_BACKCOLOR,
c.COMMAND_INSERTIMAGE,c.COMMAND_CREATELINK];"html"==l.mode?e():p();a(c.contentDocument).on("select",function(){z()}).on("mouseup",function(){b();z()}).on("keydown",function(a){27===a.keyCode&&b()}).on("keyup paste",function(){w.setTimeout(function(){z();J()},10)});a(c.contentWindow).on("focus",function(){b();z()}).on("blur",function(){r.val(c.value())});q.on("click","ul.cazary-commands-list li",function(b){a(this).hasClass("cazary-disabled")&&(b.stopImmediatePropagation(),H())});C.on("click",function(){C.hasClass("cazary-active")?
p():e();H()});a.each(D,function(){var a=this.toLowerCase();q.on("click",".cazary-command-"+a,function(){g(a)})});a.each(A,function(){var b=this.toLowerCase();q.on("click",".cazary-command-"+b,function(){var c=a(this);v(b,l,c);return!1})})})}}(v)})})(jQuery,window);